â¸»

ğŸ”¹ What It Means

During the TLS/SSL handshake, the client tells the server which SSL/TLS version it wants to use.
	â€¢	Example: â€œHi, I support TLS 1.0, 1.1, 1.2â€

The server then chooses one it also supports.
	â€¢	Example: â€œOkay, letâ€™s use TLS 1.2â€

If the client suggests a protocol version that the server does not recognize or does not allow, the handshake fails.
ğŸ‘‰ Thatâ€™s when you see: â€œunknown SSL protocol version.â€

â¸»

ğŸ”¹ Why Does It Happen?
	1.	Outdated Clients
	â€¢	A very old client (browser, VPN client, script) is trying SSLv2 or SSLv3.
	â€¢	Citrix ADC only allows TLS 1.2/1.3 â†’ handshake fails.
	2.	Malicious/Scanning Tools
	â€¢	Attackers often scan with tools (like nmap --script ssl-enum-ciphers) that send weird/unsupported versions just to test the serverâ€™s response.
	â€¢	Log shows â€œunknown SSL protocol version.â€
	3.	Misconfigured Devices
	â€¢	A device (proxy, load balancer, IoT device) using an incorrect or non-standard SSL library tries to connect.

â¸»

ğŸ”¹ Example
	â€¢	A normal user on a modern browser tries to log into Citrix Gateway â†’ TLS 1.2 handshake succeeds.
	â€¢	An old Windows XP machine using IE6 (which only supports SSLv3) tries â†’ Citrix Gateway rejects â†’ â€œunknown SSL protocol version.â€
	â€¢	An attacker runs a scan with a fake SSL version string â†’ also rejected with same error.

â¸»

ğŸ”¹ SOC Perspective
	â€¢	Benign: A few scattered events, especially from old clients, are usually harmless.
	â€¢	Suspicious:
	â€¢	A burst of these errors from many IPs â†’ reconnaissance or SSL/TLS version probing.
	â€¢	If followed by successful logins from the same IP, it could be an attacker probing then switching to a valid client.

â¸»

ğŸ”¹ Alerting Ideas
	â€¢	ğŸš¨ Alert if multiple handshake failures with â€œunknown SSL protocol versionâ€ occur from the same IP in a short time.
	â€¢	ğŸš¨ Alert if a sudden spike in these errors comes from multiple IPs (sign of scanning campaign).
	â€¢	Use these logs to baseline normal clients â†’ filter out noise (like one old printer always failing).

â¸»

âœ… In short:
â€œUnknown SSL protocol versionâ€ means the client tried to use an SSL/TLS version that Citrix ADC doesnâ€™t support or recognize.
	â€¢	Could be old/incompatible clients, but often itâ€™s attackers scanning or probing SSL settings.

â¸»
