â¸»

ğŸ”¹ What conn_delink Means
	â€¢	In Citrix NetScaler/ADC, connections are tracked in a connection table (like a session database).
	â€¢	When a connection is no longer linked to that table (e.g., after termination, timeout, or reset), the system logs conn_delink.

ğŸ‘‰ In simple terms:
conn_delink = â€œThis connection is being removed from the active session table.â€

â¸»

ğŸ”¹ When Does It Happen?
	1.	Normal Session Closure
	â€¢	User logs off VPN or closes a Citrix ICA session â†’ NetScaler â€œdelinksâ€ the connection from its tracking.
	2.	Timeouts
	â€¢	Idle timeout (user inactive).
	â€¢	TCP/SSL handshake never completed â†’ connection dropped.
	3.	Errors / Forced Closure
	â€¢	Connection reset by client/server.
	â€¢	SSL/TLS version mismatch â†’ session aborted.
	4.	Abnormal / Suspicious Behavior
	â€¢	Attacker scanning â†’ thousands of short-lived connections get delinked right away.
	â€¢	DoS/DDoS â†’ lots of half-open connections being flushed.

â¸»

ğŸ”¹ Example Scenarios

âœ… Normal
	â€¢	Log: conn_delink for user session after 2 hours.
ğŸ‘‰ User ended VPN session properly.

âš ï¸ Suspicious
	â€¢	Logs: conn_delink seen hundreds of times per minute from random IPs.
ğŸ‘‰ Could be botnet scanning or flooding Citrix Gateway.

âš ï¸ Troubleshooting
	â€¢	Repeated conn_delink for one user right after login attempt.
ğŸ‘‰ Could mean misconfigured client, expired certificate, or network issue.

â¸»

ğŸ”¹ Difference vs conn-terminate
	â€¢	conn-terminate = the connection was explicitly closed (by user logout, error, or timeout).
	â€¢	conn-delink = the connection is being unlinked/removed from ADCâ€™s session tracking (like garbage collection).

ğŸ’¡ Often, youâ€™ll see conn-terminate â†’ followed by conn-delink for the same session.

â¸»

ğŸ”¹ SOC Usefulness
	â€¢	Baseline: A few conn-delink events per user session = normal.
	â€¢	Red Flags:
	â€¢	Spikes of conn-delink without matching user activity â†’ scanning/DoS.
	â€¢	Frequent conn-delink for the same user at login â†’ config issue or brute-force attempts.

â¸»

ğŸ”¹ Alert Ideas
	â€¢	ğŸš¨ Alert if more than X conn_delink events per minute from same IP â†’ possible scan/flood.
	â€¢	ğŸš¨ Alert if conn_delink follows failed authentication repeatedly â†’ brute force.
	â€¢	ğŸš¨ Correlate with SSL handshake failures â†’ attacker probing SSL/TLS configs.

â¸»

âœ… In short:
	â€¢	conn_delink = Citrix ADC removed a connection from its active session table.
	â€¢	Normal when a user session ends, but suspicious if you see bursts, repeats, or patterns linked to failed logins/scans.

â¸»
