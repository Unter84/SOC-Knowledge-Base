🔹 What It Is
	•	sslvpn = Citrix Gateway’s SSL VPN feature (remote access into internal apps/desktops).
	•	httprequest = an HTTP(S) request made as part of the VPN session.

So:
👉 sslvpn httprequest = a user (or client) made an HTTP(S) request through the Citrix SSL VPN tunnel.

This is not just hitting the Citrix portal login page — it’s traffic that passed through the SSL VPN once the user connected (or attempted to connect).

⸻

🔹 What It Logs

Depending on config, a sslvpn httprequest log entry can show:
	•	Client IP (public IP of user).
	•	Username / session ID (if authenticated).
	•	HTTP method (GET, POST, PUT, etc.).
	•	Target URL (internal resource being accessed through VPN).
	•	Response code (200 OK, 403 Forbidden, 404 Not Found).
	•	Bytes transferred (size of request/response).

⸻

🔹 When Do You See It?
	1.	Normal Usage
	•	User connects to VPN and opens SharePoint → sslvpn httprequest /sites/team.
	•	User accesses internal HR portal → sslvpn httprequest /hr/login.aspx.
	2.	Errors / Misconfigurations
	•	User tries to reach an internal site not published → logs show 404.
	•	Old bookmarks → invalid paths.
	3.	Suspicious / Malicious
	•	Brute force → repeated POSTs to /vpn/index.html before login success.
	•	Recon → scanning for paths (/admin, /phpmyadmin, /etc/passwd).
	•	Exploitation attempts → SQL injection, XSS, directory traversal payloads in the request.
	•	Data exfiltration → large, unusual transfers via SSL VPN tunnel.

⸻

🔹 Example Scenarios

✅ Normal

sslvpn httprequest client-ip=10.10.5.25 user=john.doe method=GET url=/intranet/home response=200

👉 John accessed the internal intranet page via VPN.

⚠️ Suspicious

sslvpn httprequest client-ip=185.22.44.99 user=unknown method=POST url=/vpn/index.html response=401

👉 Repeated failed POSTs = brute force attempt.

🚨 Malicious

sslvpn httprequest client-ip=203.0.113.50 user=jane.smith method=GET url=/intranet/search?q=UNION+SELECT response=403

👉 Attempted SQL injection via the VPN web portal.

⸻

🔹 SOC Usefulness
	•	User Activity Monitoring: Who is accessing what through the SSL VPN.
	•	Threat Detection:
	•	Brute force → failed login requests.
	•	Recon → invalid/suspicious URLs requested.
	•	Exploits → payloads inside requests.
	•	Data theft → large POST requests over SSL VPN.

⸻

🔹 Example Alerts
	•	🚨 More than X failed sslvpn httprequest attempts (401 errors) in 5 minutes → password spray.
	•	🚨 Requests containing suspicious keywords (../, <script>, UNION SELECT) → web exploit attempt.
	•	🚨 Single session transferring >500MB via SSLVPN unexpectedly → potential exfiltration.

⸻

✅ In short:
sslvpn httprequest in Citrix logs = an HTTP(S) request going through the Citrix SSL VPN.
	•	Normal: User accessing intranet apps/files.
	•	Suspicious: Bursts of failed requests, abnormal URLs, exploit payloads.
	•	High value for SOC: Lets you spot brute force, reconnaissance, and exfiltration attempts over the VPN.

⸻

🔹 Fields You Mentioned
	•	method → HTTP method (GET, POST, etc.).
	•	user → Citrix VPN username (who initiated the request).
	•	uri → Path requested (e.g., /vpn/index.html, /intranet/home).
	•	domain → Target domain the user accessed through VPN.
	•	other fields → Often include session ID, client IP, bytes in/out, SSL tunnel ID, etc.

⸻

🔹 Why No Response Code?
	•	These logs are generated by the Citrix Gateway (SSLVPN) component, which acts like a tunnel broker, not a full web proxy.
	•	Its job is to log what was requested and by whom, not necessarily the backend’s response.
	•	For response codes, you’d need WAF, ADC traffic logs, or backend IIS/Apache logs.

⸻

🔹 What You Can Still Do with These Logs

Even without HTTP response codes, they are very valuable for SOC monitoring:

✅ Normal Use Case

sslvpn httprequest method=GET user=john.doe uri=/intranet/home domain=corp.local

👉 John accessed the intranet homepage through SSL VPN.

⚠️ Suspicious Use Case #1 – Recon/Brute Force

sslvpn httprequest method=POST user=john.doe uri=/vpn/index.html domain=gateway.company.com
sslvpn httprequest method=POST user=john.doe uri=/vpn/index.html domain=gateway.company.com
sslvpn httprequest method=POST user=john.doe uri=/vpn/index.html domain=gateway.company.com

👉 Multiple login POST attempts — could be password spraying.

⚠️ Suspicious Use Case #2 – Reconnaissance

sslvpn httprequest method=GET user=jane.smith uri=/admin domain=internal.company.com
sslvpn httprequest method=GET user=jane.smith uri=/phpmyadmin domain=internal.company.com

👉 User (or attacker) is probing non-Citrix paths that shouldn’t exist.

⚠️ Suspicious Use Case #3 – Possible Exploit Attempt

sslvpn httprequest method=GET user=unknown uri=/intranet/home?file=../../etc/passwd domain=internal.company.com

👉 Directory traversal attempt inside VPN traffic.

⸻

🔹 SOC Usefulness

Even without response codes, you can:
	•	Detect brute force/spray attempts → many POSTs to /vpn/index.html.
	•	Detect policy abuse → user accessing unusual domains/URIs.
	•	Detect exploitation attempts → suspicious patterns in uri field (../, <script>, UNION SELECT).
	•	Detect data exfiltration → large POST requests to unknown domains (if byte counters exist).

⸻

✅ In short:
	•	sslvpn httprequest = Citrix Gateway logging HTTP requests made inside VPN tunnels.
	•	These logs don’t show backend responses — only who (user), what (URI), where (domain), and how (method).
	•	Still very useful for SOC: spotting brute force, recon, suspicious URIs, and misuse of VPN tunnels.

⸻
